# ðŸ–¥ï¸ PODZIELONE KOMENDY DLA VNC - Åatwiejsze wklejanie
# Skopiuj i wklej kaÅ¼dÄ… czÄ™Å›Ä‡ osobno przez F8 â†’ Send Clipboard

# CZÄ˜ÅšÄ† 1: Backup i przygotowanie
sudo cp -r /opt/trading-bot /opt/trading-bot-backup-$(date +%Y%m%d) 2>/dev/null || true

# CZÄ˜ÅšÄ† 2: Utworzenie katalogu
sudo mkdir -p /opt/trading-bot

# CZÄ˜ÅšÄ† 3: Kopiowanie plikÃ³w
sudo cp ~/enhanced_server_gpt5.py ~/user_database.py ~/index.html ~/login.html ~/register.html ~/nginx_8009.conf ~/requirements.txt ~/simple_openai_client.py ~/web_search_tool.py ~/users.json /opt/trading-bot/

# CZÄ˜ÅšÄ† 4: Uprawnienia
sudo chown -R www-data:www-data /opt/trading-bot
sudo chmod +x /opt/trading-bot/enhanced_server_gpt5.py

# CZÄ˜ÅšÄ† 5: Instalacja Python pakietÃ³w
sudo python3 -m pip install --upgrade pip
sudo python3 -m pip install -r /opt/trading-bot/requirements.txt

# CZÄ˜ÅšÄ† 6: Konfiguracja nginx
sudo cp /opt/trading-bot/nginx_8009.conf /etc/nginx/sites-available/trading-bot
sudo ln -sf /etc/nginx/sites-available/trading-bot /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl reload nginx

# CZÄ˜ÅšÄ† 7: Systemd service file
sudo tee /etc/systemd/system/trading-bot.service > /dev/null << 'EOF'
[Unit]
Description=Trading Bot Server with Registration
After=network.target

[Service]
Type=simple
User=www-data
WorkingDirectory=/opt/trading-bot
ExecStart=/usr/bin/python3 enhanced_server_gpt5.py
Restart=always
RestartSec=3
Environment=PYTHONUNBUFFERED=1

[Install]
WantedBy=multi-user.target
EOF

# CZÄ˜ÅšÄ† 8: Uruchomienie serwisu
sudo systemctl daemon-reload
sudo systemctl enable trading-bot
sudo systemctl stop trading-bot 2>/dev/null || true
sudo systemctl start trading-bot

# CZÄ˜ÅšÄ† 9: Inicjalizacja bazy danych
cd /opt/trading-bot
sudo -u www-data python3 user_database.py

# CZÄ˜ÅšÄ† 10: Sprawdzenie statusu
sudo systemctl status trading-bot
curl http://localhost:8009/login
