# VPS Deployment Configuration
# This file contains deployment settings and instructions

# Server Requirements
MIN_RAM_GB=2
MIN_STORAGE_GB=20
RECOMMENDED_RAM_GB=4
RECOMMENDED_STORAGE_GB=50

# Network Configuration
DEFAULT_API_PORT=8000
DEFAULT_NGINX_PORT=80
DEFAULT_NGINX_SSL_PORT=443
DEFAULT_REDIS_PORT=6379
DEFAULT_PROMETHEUS_PORT=9090

# Service Configuration
SERVICE_USER=tradingbot
PROJECT_DIR=/opt/trading-bot
LOG_DIR=/opt/trading-bot/logs
BACKUP_DIR=/opt/trading-bot/backups

# Python Configuration
PYTHON_VERSION=3.11
VENV_PATH=/opt/trading-bot/venv

# Database Configuration
DEFAULT_DB_PATH=/opt/trading-bot/trading.db
POSTGRESQL_DB_NAME=trading_bot
POSTGRESQL_USER=tradingbot

# Security Configuration
JWT_SECRET_LENGTH=64
SECRET_KEY_LENGTH=32

# Monitoring Configuration
LOG_RETENTION_DAYS=30
BACKUP_RETENTION_DAYS=7
HEALTH_CHECK_INTERVAL=60

# Performance Tuning
UVICORN_WORKERS=2
GUNICORN_WORKERS=4
WORKER_CONNECTIONS=1000
MAX_REQUESTS=1000
MAX_REQUESTS_JITTER=100

# Rate Limiting
RATE_LIMIT_PER_MINUTE=100
RATE_LIMIT_BURST=200

# SSL Configuration
SSL_CERT_PATH=/etc/letsencrypt/live
SSL_RENEWAL_DAYS=30

# Backup Configuration
BACKUP_SCHEDULE="0 2 * * *"  # Daily at 2 AM
DATABASE_BACKUP_SCHEDULE="0 */6 * * *"  # Every 6 hours

# Monitoring Alerts
CPU_ALERT_THRESHOLD=80
MEMORY_ALERT_THRESHOLD=85
DISK_ALERT_THRESHOLD=90
API_RESPONSE_TIME_THRESHOLD=5000  # milliseconds

# Environment Variables Template
ENV_VARIABLES=(
    "ENVIRONMENT=production"
    "DEBUG=false"
    "API_HOST=0.0.0.0"
    "API_PORT=8000"
    "LOG_LEVEL=INFO"
    "REDIS_URL=redis://localhost:6379/0"
    "DATABASE_URL=sqlite:///./trading.db"
    "JWT_SECRET="
    "SECRET_KEY="
    "OPENAI_API_KEY="
    "ANTHROPIC_API_KEY="
    "BINANCE_API_KEY="
    "BINANCE_SECRET_KEY="
    "BINANCE_TESTNET=true"
    "BYBIT_API_KEY="
    "BYBIT_SECRET_KEY="
    "BYBIT_TESTNET=true"
    "PRIMEXBT_API_KEY="
    "PRIMEXBT_SECRET_KEY="
    "ENABLE_PROMETHEUS=true"
    "PROMETHEUS_PORT=9090"
    "SMTP_SERVER="
    "SMTP_PORT=587"
    "SMTP_USERNAME="
    "SMTP_PASSWORD="
    "FROM_EMAIL="
    "TELEGRAM_BOT_TOKEN="
    "TELEGRAM_CHAT_ID="
)

# File Permissions
PERMISSION_CONFIGS=(
    "$PROJECT_DIR:755:$SERVICE_USER:$SERVICE_USER"
    "$PROJECT_DIR/.env:600:$SERVICE_USER:$SERVICE_USER"
    "$PROJECT_DIR/logs:755:$SERVICE_USER:$SERVICE_USER"
    "$PROJECT_DIR/backups:700:$SERVICE_USER:$SERVICE_USER"
    "$PROJECT_DIR/data:755:$SERVICE_USER:$SERVICE_USER"
)

# System Dependencies
SYSTEM_PACKAGES=(
    "curl"
    "wget"
    "git"
    "unzip"
    "software-properties-common"
    "apt-transport-https"
    "ca-certificates"
    "gnupg"
    "lsb-release"
    "build-essential"
    "libffi-dev"
    "libssl-dev"
    "libbz2-dev"
    "libreadline-dev"
    "libsqlite3-dev"
    "tk-dev"
    "libpng-dev"
    "libfreetype6-dev"
    "redis-server"
    "nginx"
    "postgresql"
    "postgresql-contrib"
    "postgresql-client"
    "ufw"
    "fail2ban"
    "htop"
    "iotop"
    "net-tools"
    "supervisor"
)

# Python Packages
PYTHON_PACKAGES=(
    "fastapi"
    "uvicorn[standard]"
    "gunicorn"
    "pydantic"
    "sqlalchemy"
    "alembic"
    "redis"
    "celery"
    "websockets"
    "jwt"
    "passlib"
    "bcrypt"
    "python-multipart"
    "jinja2"
    "aiofiles"
    "httpx"
    "pandas"
    "numpy"
    "ccxt"
    "openai"
    "anthropic"
    "prometheus-client"
    "psutil"
    "python-dotenv"
    "cryptography"
    "requests"
    "aioredis"
    "asyncpg"
)

# Service Templates
SYSTEMD_SERVICES=(
    "trading-bot-api"
    "trading-bot"
    "trading-bot-monitor"
)

# Health Check Endpoints
HEALTH_ENDPOINTS=(
    "/"
    "/health"
    "/api/health"
    "/api/status"
)

# Monitoring Metrics
PROMETHEUS_METRICS=(
    "trading_bot_api_requests_total"
    "trading_bot_api_request_duration_seconds"
    "trading_bot_balance_total"
    "trading_bot_trades_total"
    "trading_bot_errors_total"
    "trading_bot_users_active"
    "trading_bot_websocket_connections"
)

# Log Files to Monitor
LOG_FILES=(
    "/opt/trading-bot/logs/app.log"
    "/opt/trading-bot/logs/trading.log"
    "/opt/trading-bot/logs/api.log"
    "/opt/trading-bot/logs/monitor.log"
    "/var/log/nginx/access.log"
    "/var/log/nginx/error.log"
)

# Backup Patterns
BACKUP_INCLUDE=(
    "/opt/trading-bot/*.py"
    "/opt/trading-bot/bot/"
    "/opt/trading-bot/web/"
    "/opt/trading-bot/.env"
    "/opt/trading-bot/trading.db"
    "/opt/trading-bot/requirements.txt"
)

BACKUP_EXCLUDE=(
    "/opt/trading-bot/venv/"
    "/opt/trading-bot/__pycache__/"
    "/opt/trading-bot/**/__pycache__/"
    "/opt/trading-bot/logs/"
    "/opt/trading-bot/**/*.pyc"
    "/opt/trading-bot/**/*.pyo"
)

# SSL Certificate Domains
SSL_DOMAINS=()  # Add your domains here

# Email Notification Settings
EMAIL_ALERTS=(
    "system_high_cpu"
    "system_high_memory"
    "system_high_disk"
    "service_down"
    "api_error_rate_high"
    "trading_error"
    "security_alert"
)

# Telegram Notification Settings
TELEGRAM_ALERTS=(
    "service_started"
    "service_stopped"
    "trade_executed"
    "balance_low"
    "api_error"
    "system_alert"
)

# Firewall Rules
UFW_RULES=(
    "allow ssh"
    "allow 80/tcp"
    "allow 443/tcp"
    "allow from 127.0.0.1 to any port 6379"
    "allow from 127.0.0.1 to any port 9090"
)

# Fail2Ban Configuration
FAIL2BAN_JAILS=(
    "sshd"
    "nginx-http-auth"
    "nginx-limit-req"
)

# Cron Jobs
CRON_JOBS=(
    "0 2 * * * /opt/trading-bot/backup.sh"
    "0 0 * * 0 /opt/trading-bot/cleanup.sh"
    "*/5 * * * * /opt/trading-bot/health_check.sh"
    "0 3 * * * certbot renew --quiet"
)

# Environment Validation
REQUIRED_ENV_VARS=(
    "JWT_SECRET"
    "SECRET_KEY"
    "OPENAI_API_KEY"
)

OPTIONAL_ENV_VARS=(
    "ANTHROPIC_API_KEY"
    "BINANCE_API_KEY"
    "BYBIT_API_KEY"
    "PRIMEXBT_API_KEY"
    "TELEGRAM_BOT_TOKEN"
    "SMTP_USERNAME"
)

# Performance Benchmarks
PERFORMANCE_TARGETS=(
    "api_response_time_p95:1000ms"
    "concurrent_users:100"
    "requests_per_second:50"
    "memory_usage:80%"
    "cpu_usage:70%"
)

# Update Schedule
UPDATE_SCHEDULE="0 4 * * 1"  # Weekly on Monday at 4 AM

# Deployment Checklist
DEPLOYMENT_CHECKLIST=(
    "✓ Server requirements met"
    "✓ DNS records configured"
    "✓ SSL certificate installed"
    "✓ Environment variables set"
    "✓ Database initialized"
    "✓ Services running"
    "✓ Health checks passing"
    "✓ Monitoring configured"
    "✓ Backups scheduled"
    "✓ Security configured"
    "✓ Documentation updated"
)
